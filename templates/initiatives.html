<div class="space-y-6">
    <h3 class="text-xl font-semibold text-[#1f2937]">All 154 Initiatives by FTE Allocation</h3>
    {% set with_desc = initiatives | selectattr('description') | list %}
    {% set without_desc = initiatives | rejectattr('description') | list %}
    <p class="text-sm text-[#6b7280] mb-4">ðŸ’¡ {{ with_desc | length }} major initiatives with full descriptions | {{ without_desc | length }} supporting initiatives</p>
    <div class="bg-white rounded-lg shadow-md overflow-y-auto" style="max-height: 800px;">
        <table class="w-full">
            <thead>
                <tr class="bg-[#0053e2] text-white sticky top-0">
                    <th class="px-6 py-3 text-left font-semibold">Initiative Name</th>
                    <th class="px-6 py-3 text-right font-semibold">FTEs</th>
                    <th class="px-6 py-3 text-right font-semibold">% of Total</th>
                    <th class="px-6 py-3 text-right font-semibold">Allocation</th>
                </tr>
            </thead>
            <tbody>
                <!-- MAJOR INITIATIVES WITH DESCRIPTIONS -->
                {% for initiative in with_desc %}
                <tr class="border-b border-[#e5e7eb] hover:bg-[#f9fafb] transition-colors group relative bg-yellow-50">
                    <td class="px-6 py-4 font-medium text-[#1f2937] cursor-help" data-id="{{ initiative.id }}">
                        {{ initiative.name }}
                        <!-- Tooltip -->
                        <div class="hidden group-hover:block absolute left-0 right-0 top-full bg-gray-900 text-white p-4 rounded-lg shadow-lg z-50 w-96 text-xs mt-2 pointer-events-none" style="white-space: normal; line-height: 1.4;">
                            <p class="font-semibold mb-2 text-[#ffc220]">{{ initiative.name }}</p>
                            <p class="text-gray-200">{{ initiative.description }}</p>
                        </div>
                    </td>
                    <td class="px-6 py-4 text-right text-[#0053e2] font-semibold">{{ "%.2f" | format(initiative.fte) }}</td>
                    <td class="px-6 py-4 text-right text-[#6b7280]">{{ "%.2f" | format(initiative.percent) }}%</td>
                    <td class="px-6 py-4">
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="progress-bar h-2 rounded-full" style="width: {{ initiative.percent }}%"></div>
                        </div>
                    </td>
                </tr>
                {% endfor %}
                
                <!-- SUPPORTING INITIATIVES HEADER (COLLAPSIBLE) -->
                {% set supporting_fte_total = without_desc | map(attribute='fte') | sum %}
                {% set supporting_percent_total = without_desc | map(attribute='percent') | sum %}
                <tr class="bg-gradient-to-r from-[#e5e7eb] to-[#e5e7eb] cursor-pointer hover:from-[#d1d5db] hover:to-[#d1d5db] transition-colors" onclick="toggleSupportingInitiatives()">
                    <td class="px-6 py-3">
                        <span class="text-sm font-semibold text-[#6b7280]"><span id="supportingToggle">â–¼</span> ðŸ“‹ Supporting Initiatives ({{ without_desc | length }})</span>
                    </td>
                    <td class="px-6 py-3 text-right font-semibold text-[#0053e2]">{{ "%.2f" | format(supporting_fte_total) }}</td>
                    <td class="px-6 py-3 text-right font-semibold text-[#6b7280]">{{ "%.2f" | format(supporting_percent_total) }}%</td>
                    <td></td>
                </tr>
                
                <!-- SUPPORTING INITIATIVES WITHOUT DESCRIPTIONS (COLLAPSIBLE) -->
                <tbody id="supportingInitiativesBody">
                    {% for initiative in without_desc %}
                    <tr class="border-b border-[#e5e7eb] hover:bg-[#f9fafb] transition-colors">
                        <td class="px-6 py-4 font-medium text-[#6b7280]">{{ initiative.name }}</td>
                        <td class="px-6 py-4 text-right text-[#0053e2] font-semibold">{{ "%.2f" | format(initiative.fte) }}</td>
                        <td class="px-6 py-4 text-right text-[#6b7280]">{{ "%.2f" | format(initiative.percent) }}%</td>
                        <td class="px-6 py-4">
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="progress-bar h-2 rounded-full" style="width: {{ initiative.percent }}%"></div>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </tbody>
        </table>
    </div>
    <p class="text-sm text-[#6b7280] mt-6"><strong>Legend:</strong> Yellow background = Major initiatives with full descriptions (hover to read). Standard white = Supporting initiatives without detailed descriptions. The top 3 initiatives (MX-CAM, COE, and Cost Optimization) consume 36.46% of total initiative resources.</p>
</div>

<script>
function toggleSupportingInitiatives() {
    const body = document.getElementById('supportingInitiativesBody');
    const toggle = document.getElementById('supportingToggle');
    if (body.style.display === 'none') {
        body.style.display = '';
        toggle.textContent = 'â–¼';
    } else {
        body.style.display = 'none';
        toggle.textContent = 'â–¶';
    }
}
</script>
